(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{822:function(s,v,t){"use strict";t.r(v);var _=t(72),e=Object(_.a)({},(function(){var s=this,v=s.$createElement,t=s._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("[TOC]")]),s._v(" "),t("h2",{attrs:{id:"安装后的svn配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装后的svn配置"}},[s._v("#")]),s._v(" 安装后的SVN配置")]),s._v(" "),t("blockquote",[t("p",[s._v("我们一般在linux都安装了svn，然后通过svn来管理代码。安装教程就赘述了，基本就是解压-编译-编译-安装。这里我讲svn安装完后的配置仓库方法。")])]),s._v(" "),t("h3",{attrs:{id:"创建目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建目录"}},[s._v("#")]),s._v(" 创建目录")]),s._v(" "),t("blockquote",[t("p",[s._v("仓库目录创建在哪里都可以。只要你能找到，就ok。\n例：/usr/local/svn/yexk_test")])]),s._v(" "),t("p",[s._v("命令："),t("code",[s._v("mkdir yexk_test")]),s._v(" "),t("img",{attrs:{src:"images/svn_mkdir.jpg",alt:"images/svn_mkdir.jpg"}})]),s._v(" "),t("h3",{attrs:{id:"创建仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建仓库"}},[s._v("#")]),s._v(" 创建仓库")]),s._v(" "),t("p",[s._v("进入"),t("code",[s._v("yexk_test")]),s._v("目录创建仓库。\n命令："),t("code",[s._v("svnadmin create .")]),s._v("（注意后面有点，指到当前目录）\n"),t("img",{attrs:{src:"images/svn_create.jpg",alt:"images/svn_create.jpg"}})]),s._v(" "),t("blockquote",[t("p",[s._v("查看目录，可以发现已经多了，conf、db、hooks等目录或文件。")])]),s._v(" "),t("h3",{attrs:{id:"配置仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置仓库"}},[s._v("#")]),s._v(" 配置仓库")]),s._v(" "),t("p",[s._v("配置文件都在"),t("code",[s._v("conf")]),s._v("目录下。分别是"),t("code",[s._v("svnserve.conf")]),s._v("、"),t("code",[s._v("passwd")]),s._v(" 、"),t("code",[s._v("authz")]),s._v("。")]),s._v(" "),t("ol",[t("li",[s._v("打开读写权限控制\n编辑"),t("code",[s._v("svnserve.conf")]),s._v("文件。安装图修改，修改后保存退出。\n"),t("img",{attrs:{src:"images/svn_open_config.jpg",alt:"images/svn_open_config.jpg"}})])]),s._v(" "),t("blockquote",[t("p",[s._v("注意：anon-access=read 必须打开，并且改成none，不然任何人都可以下载代码了。同时要注意配置前面不要有空格。\npassword-db 和 authz-db 的这两个文件是可以重新定义的。如果你有需求改成多仓库统一配置就需要改目录位置。")])]),s._v(" "),t("p",[s._v("2）创建用户密码\n编辑"),t("code",[s._v("passwd")]),s._v("文件。添加用户。保存退出。\n"),t("img",{attrs:{src:"images/svn_conf_pass.jpg",alt:"images/svn_conf_pass.jpg"}})]),s._v(" "),t("blockquote",[t("p",[s._v("创建格式是：用户名 = 密码")])]),s._v(" "),t("p",[s._v("3）分配权限\n编辑"),t("code",[s._v("authz")]),s._v("文件。\n"),t("img",{attrs:{src:"images/svn_conf_auth.jpg",alt:"images/svn_conf_auth.jpg"}})]),s._v(" "),t("blockquote",[t("p",[s._v("根据权限或者权限组来分配对应的读写权限。")])]),s._v(" "),t("p",[s._v("这里配置就已经完成了。最后启动服务就行了。")]),s._v(" "),t("h3",{attrs:{id:"启动svn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动svn"}},[s._v("#")]),s._v(" 启动svn")]),s._v(" "),t("p",[s._v("命令："),t("code",[s._v("svnserve -d -r /usr/local/svn/")]),s._v("(-d:服务在后台进行,-r:把后面的目录当成根目录运行)")]),s._v(" "),t("p",[s._v("接下来就可以访问请求了。\n"),t("code",[s._v("svn checkout svn://IP地址/仓库目录/")])]),s._v(" "),t("blockquote",[t("p",[s._v("输入账号密码就可以。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"images/svn_complete.jpg",alt:"images/svn_complete.jpg"}})]),s._v(" "),t("p",[s._v("启动后我先说题外话，一般用户配置的仓库都不会是单一个的。所以这里就有多仓库的问题了。我该怎么启动svn。\n比如我这里的仓库目录是"),t("code",[s._v("/usr/local/svn/yexk_test")]),s._v("，一般不推荐把服务根目录挂在仓库同级下。\n也就是不推荐"),t("code",[s._v("svnserve -d -r /usr/local/svn/yexk_test/")]),s._v("这样启动服务。\n如果有需求需要添加第二个仓库，那么这个时候就有点麻烦了。")]),s._v(" "),t("h3",{attrs:{id:"自动同步（非必要）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自动同步（非必要）"}},[s._v("#")]),s._v(" 自动同步（非必要）")]),s._v(" "),t("blockquote",[t("p",[s._v("此步骤仅仅为了线上环境可以和web文件同步。\n自动同步文件是在hooks目录下的一个post-commit文件。")])]),s._v(" "),t("p",[s._v("1） 进入到仓库目录下的"),t("code",[s._v("hooks")]),s._v("目录。\n2） 复制一份"),t("code",[s._v("post-commit.tmpl")]),s._v("文件，并且重名为"),t("code",[s._v("post-commit")]),s._v("。\n命令："),t("code",[s._v("cp post-commit.tmpl post-commit")]),s._v("\n3） 分配755权限。\n命令："),t("code",[s._v("chmod 755 post-commit")]),s._v("\n4） 添加一段代码，用于自动更新代码到web仓库。\n"),t("code",[s._v('EPOS="$1" \tREV="$2" \texport LANG=en_US.UTF-8 \tWEB_PATH=/www/yexk_test/ # web项目地址 \tSVN_USER=yexk # svn用户名 \tSVN_PASS=admin # svn密码 \tLOG_PATH=/tmp/svn_yexk.log # 日志文件。可以忽略 \techo `date "+%Y-%m-%d %H:%M:%S"` >> $LOG_PATH # 日志文件。可以忽略 \techo `whoami`,$REPOS,$REV >> $LOG_PATH # 日志文件。可以忽略 \tsvn update $WEB_PATH --username $SVN_USER --password $SVN_PASS --no-auth-cache >> $LOG_PATH \t# 如果忽略了日志文件最后的输出就免了。')])]),s._v(" "),t("p",[t("img",{attrs:{src:"images/svn_auto_up.jpg",alt:"images/svn_auto_up.jpg"}})])])}),[],!1,null,null,null);v.default=e.exports}}]);